package application;

import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import util.CapsJdbc;
import util.CapsRes;
import util.CapsTableView;
import javafx.scene.Scene;
import javafx.scene.control.Button;

import javafx.scene.control.TextField;
<<<<<<< HEAD
import util.CapsJdbc;
import util.CapsTableView;
=======
import javafx.scene.control.cell.PropertyValueFactory;
>>>>>>> branch 'master' of git@github.com:weijianjiang09/test.git

import java.net.URL;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.List;
import java.util.Map;
import java.util.ResourceBundle;

import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;

import javafx.scene.control.Label;

import javafx.scene.control.TableView;

import javafx.scene.control.TableColumn;

public class StudentMainController implements Initializable {
	@FXML
	private Label txtcno_0;
	@FXML
	private Label txtclassnum_0;
	@FXML
	private Label txtname_0;
	@FXML
	private Label txtsex_0;
	@FXML
	private Button btnupdate;
	@FXML
	private Label txtsno_0;
	@FXML
	private TextField txtcourse_1;
	@FXML
	private Button btnresults_1;
	@FXML
	private Label txtresult_1;
	@FXML
	private TextField txtclass_num_2;
	@FXML
	private TextField txtcourse_2;
	@FXML
	private Button btnresults_2;
	@FXML
	private Label txtresult_2;
	@FXML
	private TextField txtcourse_3;
	@FXML
	private Button btnresult_3;
	@FXML
	private TableView<Map<String,String>> txtcoursechart_3;

	private CapsRes capsRes;
	@FXML
	private TableColumn chart_coursename;
	@FXML
	private TableColumn chart_coursepreposition;
	@FXML
	private TableColumn chart_credit;
	public String txtUserId;
	// Event Listener on Button[#btnupdate].onAction
	public void updateAction(ActionEvent event) throws Exception{
		// TODO Autogenerated
		
	}
	// Event Listener on Button[#btnresults_1].onAction
	@FXML
	public void btnresults_1Action(ActionEvent event) {
		// TODO Autogenerated

	}
	// Event Listener on Button[#btnresults_2].onAction
	@FXML
	public void btnresults_2Action(ActionEvent event) {
		String strSQL = "select starttime,endtime from course_room where classroon_num='"+txtclass_num_2.getText()+"' and course="+txtcourse_2.getText()+";";
		capsRes = CapsJdbc.execSQL(strSQL,null);
		
		txtresult_2.setText(capsRes.getRs().get(0).get(0));
//		System.out.println(capsRes.getRs());
	}
	// Event Listener on Button[#btnresult_3].onAction
	@FXML
<<<<<<< HEAD
	public void btnresults_3Action(ActionEvent event) {
		String strSQL = "select * from course where course_num="+txtcourse_3.getText();
		capsRes = CapsJdbc.execSQL(strSQL,null);
		txtcoursechart_3.setItems(null);
		txtcoursechart_3.getColumns().clear();
		CapsTableView.dealTableView(capsRes,txtcoursechart_3);
		System.out.println(txtUserId);
	}
	@Override
	public void initialize(URL location, ResourceBundle resources) {
		// TODO 自动生成的方法存根
		String strSQL = "select * from course ";
		capsRes = CapsJdbc.execSQL(strSQL,null);
		txtcoursechart_3.setItems(null);
		txtcoursechart_3.getColumns().clear();
		CapsTableView.dealTableView(capsRes,txtcoursechart_3);
		System.out.println(txtUserId);
	}
	public void initData(String string) {
		this.txtUserId=string;
=======
	public void btnresults_3Action(ActionEvent event) throws Exception {
		// TODO Autogenerated
		final ObservableList<Person> data =
		        FXCollections.observableArrayList(
		            new Person("...","...", "...", "...")
		        );
	      TableColumn firsNameCol = new TableColumn("课程编码");
	      firsNameCol.setMinWidth(100);
	      firsNameCol.setCellValueFactory(
	              new PropertyValueFactory<>("Num"));
	      
	      TableColumn firstNameCol = new TableColumn("课程名");
	      firstNameCol.setMinWidth(100);
	      firstNameCol.setCellValueFactory(
	              new PropertyValueFactory<>("firstName"));

	      TableColumn lastNameCol = new TableColumn("先行课程号");
	      lastNameCol.setMinWidth(100);
	      lastNameCol.setCellValueFactory(
	              new PropertyValueFactory<>("lastName"));

	      TableColumn emailCol = new TableColumn("学分");
	      emailCol.setMinWidth(200);
	      emailCol.setCellValueFactory(
	              new PropertyValueFactory<>("email"));
	      txtcoursechart_3.getColumns().addAll(firsNameCol,firstNameCol, lastNameCol, emailCol);
	      String course_num=null;
	      String course_name=null;
	      String course_preposition=null;
	      String credit=null;
		PreparedStatement ps = null;
		ResultSet res = null;
	Connection conn = null;
	Class.forName("com.mysql.cj.jdbc.Driver");
	conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/sss?useSSL=false&serverTimezone=UTC","root","111111");
	ps = conn.prepareStatement("SELECT * FROM course");
	res = ps.executeQuery();
	while(res.next()) {
		course_num=res.getString(1);
		course_name=res.getString(2);
		course_preposition=res.getString(3);
		credit=res.getString(4);
	
		 
		
		 data.add(new Person(course_num,course_name,course_preposition,credit));
			    
	}
	txtcoursechart_3.setItems(data);
>>>>>>> branch 'master' of git@github.com:weijianjiang09/test.git
	}
}
